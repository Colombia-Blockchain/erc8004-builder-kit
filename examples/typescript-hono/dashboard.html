<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My ERC-8004 Agent</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif; background:#0a0a0f; color:#e0e0e0; min-height:100vh; display:flex; justify-content:center; padding:40px 20px; }
    .container { max-width:700px; width:100%; }
    h1 { font-size:2rem; margin-bottom:8px; color:#fff; }
    .tagline { color:#888; margin-bottom:32px; font-size:0.95rem; }
    .status { display:inline-block; background:#0d3; color:#000; font-size:0.7rem; padding:3px 10px; border-radius:20px; font-weight:700; margin-bottom:24px; }
    .card { background:#12121a; border:1px solid #222; border-radius:12px; padding:20px; margin-bottom:16px; }
    .card h2 { font-size:0.85rem; color:#888; text-transform:uppercase; letter-spacing:1px; margin-bottom:12px; }
    .card p { font-size:0.9rem; line-height:1.6; color:#ccc; }
    .tools { display:grid; gap:8px; }
    .tool { background:#1a1a2e; border:1px solid #333; border-radius:8px; padding:12px 16px; }
    .tool-name { font-weight:700; color:#7df; font-family:monospace; font-size:0.85rem; }
    .tool-desc { color:#999; font-size:0.8rem; margin-top:4px; }
    .links { display:flex; flex-wrap:wrap; gap:8px; margin-top:12px; }
    .links a { color:#7df; text-decoration:none; font-size:0.8rem; background:#1a1a2e; padding:6px 12px; border-radius:6px; border:1px solid #333; }
    .links a:hover { background:#222; }
    .footer { text-align:center; color:#555; font-size:0.75rem; margin-top:32px; }
    #mcp-tools { min-height:40px; }
    .loading { color:#666; font-size:0.8rem; }
  </style>
</head>
<body>
  <div class="container">
    <span class="status">ONLINE</span>
    <h1 id="agent-name">My ERC-8004 Agent</h1>
    <p class="tagline" id="agent-desc">Loading...</p>

    <div class="card">
      <h2>About</h2>
      <p id="agent-about">This agent is registered on-chain using the ERC-8004 standard. It can be discovered by other agents and scanners.</p>
    </div>

    <div class="card">
      <h2>MCP Tools</h2>
      <div id="mcp-tools" class="tools">
        <span class="loading">Loading tools...</span>
      </div>
    </div>

    <div class="card">
      <h2>Endpoints</h2>
      <div class="links">
        <a href="/api/health">Health Check</a>
        <a href="/registration.json">Registration JSON</a>
        <a href="/.well-known/agent-card.json">A2A Card</a>
      </div>
    </div>

    <div class="card">
      <h2>Resources</h2>
      <div class="links">
        <a href="https://www.8004.org" target="_blank">8004.org</a>
        <a href="https://8004scan.io" target="_blank">8004scan.io</a>
        <a href="https://www.erc-8004scan.xyz/scanner" target="_blank">ERC-8004 Scanner</a>
      </div>
    </div>

    <div class="footer">
      Powered by ERC-8004
    </div>
  </div>

  <script>
    const API = window.location.origin;

    // Load agent info from registration.json
    fetch(API + '/registration.json')
      .then(r => r.json())
      .then(data => {
        document.getElementById('agent-name').textContent = data.name || 'My Agent';
        document.getElementById('agent-desc').textContent = data.description || '';
      })
      .catch(() => {});

    // Load MCP tools
    fetch(API + '/mcp', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ jsonrpc: '2.0', method: 'tools/list', id: 1 })
    })
      .then(r => r.json())
      .then(data => {
        const tools = data.result?.tools || [];
        const container = document.getElementById('mcp-tools');
        if (tools.length === 0) {
          container.innerHTML = '<span class="loading">No tools available</span>';
          return;
        }
        container.innerHTML = tools.map(t =>
          '<div class="tool">' +
            '<div class="tool-name">' + t.name + '</div>' +
            '<div class="tool-desc">' + (t.description || '') + '</div>' +
          '</div>'
        ).join('');
      })
      .catch(() => {
        document.getElementById('mcp-tools').innerHTML = '<span class="loading">Could not load tools</span>';
      });
  </script>
</body>
</html>
